<!DOCTYPE html>
<html lang="zh-HK">
<head>
<meta charset="UTF-8">
<title>股票評級排行榜</title>
<meta name="description" content="每日自動更新的股票評級排行榜，只顯示結果，不公開計算方法。">
<style>
body {
  font-family: Arial, sans-serif;
  background: #f6f7f9;
  padding: 40px;
}
h1 {
  text-align: center;
}
table {
  width: 100%;
  max-width: 900px;
  margin: 30px auto;
  border-collapse: collapse;
  background: #fff;
}
th, td {
  padding: 12px;
  border-bottom: 1px solid #ddd;
  text-align: center;
}
th {
  background: #222;
  color: #fff;
}
.buy { color: green; font-weight: bold; }
.sell { color: red; font-weight: bold; }
.hold { color: #666; font-weight: bold; }
</style>
</head>

<body>

<h1>股票評級排行榜</h1>

<table id="stockTable">
  <thead>
    <tr>
      <th>股票</th>
      <th>現價</th>
      <th>評級</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQndjBqUVsGNWfRpgZzwiuoum6dRsQuIEvouN3D7za_DHgIl-X3nVrVs13VxA7MvIPIau32if2ntiAS/pub?gid=241210704&single=true&output=csv';

fetch(CSV_URL)
  .then(r => r.text())
  .then(csv => {
    const lines = csv.trim().split('\n');
    const tbody = document.querySelector('#stockTable tbody');

    // 跳過 header
    for (let i = 1; i < lines.length; i++) {
      const cols = lines[i].split(',');
      const code = cols[0];
      const price = cols[1];
      const rating = cols[2];

      let cls = '';
      if (rating === 'BUY') cls = 'buy';
      if (rating === 'SELL') cls = 'sell';
      if (rating === 'HOLD') cls = 'hold';

      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${code}</td>
        <td>${price}</td>
        <td class="${cls}">${rating}</td>
      `;
      tbody.appendChild(tr);
    }
  })
  .catch(err => {
    document.body.insertAdjacentHTML(
      'beforeend',
      '<p style="color:red;text-align:center;">資料載入失敗</p>'
    );
  });
</script>

</body>
</html>
